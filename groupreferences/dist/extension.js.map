{"version":3,"file":"extension.js","mappings":"0HAAA,eAmBA,MAAaA,UAAiBC,EAAOC,SAIjCC,YAAYC,GAKR,GAHAC,MAAMD,EAAKE,KAAMF,EAAKG,OAASN,EAAOO,yBAAyBC,SAAWR,EAAOO,yBAAyBE,MAC1GC,KAAKP,KAAOA,EAEO,GAAfA,EAAKG,OACT,CACI,MAAMK,EAAiB,CACnBC,eAAe,EACfC,SAAS,EAGTC,UAAWX,EAAKY,OAEpBL,KAAKM,QAAU,CACXA,QAAS,cACTC,MAAO,KACPC,UAAW,CAACf,EAAKgB,IAAKR,G,MAI1BD,KAAKU,SAAWpB,EAAOqB,UAAUC,KACjCZ,KAAKa,YAAcpB,EAAKgB,IAAIK,OAC5Bd,KAAKe,QAAUtB,EAAKgB,IAAIK,MAEhC,EA7BJ,aAiCA,qBAYItB,YAAYwB,GARJ,KAAAC,aAAiE,IAAI3B,EAAO4B,aAEpF,KAAAC,oBAAqFnB,KAAKiB,aAAaG,MAEhG,KAAAC,YAAgC,GAE/B,KAAAC,cAAwB,EAI5BtB,KAAKsB,aAAeN,CACxB,CAEAO,UAEIvB,KAAKiB,cAAcO,KAAK,KAC5B,CAEAC,YAAYC,GAGR,OADW,IAAIrC,EAASqC,EAE5B,CACAC,YAAYC,GAGR,GAA+B,GAA3B5B,KAAKqB,YAAYQ,OAEjB,OAAO,KAGX,GAAID,EACJ,CACI,GAAuB,GAAnBA,EAAShC,OAET,OAAO,KAEX,IAAIkC,EAAW,GACf,IAAK,IAAIC,EAAQ,EAAGA,EAAQ/B,KAAKqB,YAAYQ,OAAQE,IACrD,CACI,IAAIC,EAAYhC,KAAKqB,YAAYU,GAC7BE,EAAMD,EAAUC,IAChBxB,EAAMwB,EAAIxB,IAEd,GAAIT,KAAKsB,cAEL,IAAKU,EAAUhB,QAEX,cAIJ,GAAyB,GAArBgB,EAAUhB,QAEV,SAIR,GAAIP,EAAIyB,YAAcN,EAASnB,IAAIyB,WAE/B,SAIJ,IAKIzC,EAAiB,CACjBgB,IAAKA,EACLd,KAPsC,CACtCwC,MAAOH,EAAUI,SACjBC,WAAY,CAAC,CAACJ,EAAI5B,MAAMiC,MAAMC,UAAWN,EAAI5B,MAAMmC,IAAID,aAMvD3C,QAAQ,EACR6C,KAAMR,EAAI5B,MAAMiC,MAAMG,KACtBpC,MAAO4B,EAAI5B,OAEfyB,EAASY,KAAKjD,E,CASlB,OANAqC,EAASa,MAAK,CAACC,EAAGC,KAEdD,EAAEH,KAAOG,EAAEH,KAAOG,EAAEH,KAAO,EAC3BI,EAAEJ,KAAOI,EAAEJ,KAAOI,EAAEJ,KAAO,EACpBG,EAAEH,KAAOI,EAAEJ,QAEfX,C,CAEX,CACI,IAAIA,EAAW,GACf,IAAIgB,EAAU,IAAIC,IAClB,IAAK,IAAIhB,EAAQ,EAAGA,EAAQ/B,KAAKqB,YAAYQ,OAAQE,IACrD,CACI,IAAIC,EAAYhC,KAAKqB,YAAYU,GAE7BtB,EADMuB,EAAUC,IACNxB,IAEd,GAAIT,KAAKsB,cAEL,IAAKU,EAAUhB,QAEX,cAIJ,GAAyB,GAArBgB,EAAUhB,QAEV,SAIR,GAAI8B,EAAQE,IAAIvC,EAAIyB,YAEhB,SAEJ,IAAIzC,EAAiB,CACjBgB,IAAKA,EACLd,KAAMK,KAAKiD,kBAAkBxC,EAAIyC,MACjCtD,QAAQ,GAGZkD,EAAQK,IAAI1C,EAAIyB,YAEhBJ,EAASY,KAAKjD,E,CAElB,OAAOqC,C,CAEf,CAEOsB,eAAe/B,GAElBrB,KAAKqB,YAAcA,EACnBrB,KAAKuB,SACT,CAGA0B,kBAAkBC,GAEd,IAAInB,EAAQmB,EAAKG,YAAY,MAK7B,OAJc,GAAVtB,IAEAA,EAAQmB,EAAKG,YAAY,OAEf,GAAVtB,EAEOmB,EAAKI,UAAUvB,EAAQ,GAE3BmB,CACX,E,qHCxMJ,eACA,SAEA,MAAaK,EAST/D,cAEI,IAAIgE,EAAQxD,KACZA,KAAKyD,aAAe,IAAInE,EAAO4B,aAC/BlB,KAAK0D,WAAa,IAAIC,IACtB3D,KAAK4D,kBAAoBtE,EAAOuE,OAAOC,+BAA+B,CAAEC,eAAgB,cAGxF/D,KAAKgE,eAAiB1E,EAAO2E,UAAUC,wBAAuB,SAAUC,GAAO,OAAOX,EAAME,WAAWU,OAAOD,EAAI1D,IAAIyB,WAAa,GACvI,CACAmC,UAEIrE,KAAKgE,eAAeK,UACpBrE,KAAK0D,WAAWY,QAChBtE,KAAK4D,kBAAkBS,UACvBrE,KAAKyD,aAAaY,SACtB,CAMIE,kBAEA,OAAOvE,KAAKyD,aAAarC,KAC7B,CAOAoD,2BAA2B/D,GAEvB,IAAI+C,EAAQxD,KAERyE,EAAWzE,KAAK0D,WAAWgB,IAAIjE,EAAIyB,YACvC,GAAIuC,EAEA,OAAOA,EAASE,MAMpB,IAAIC,EAAKC,EAAepE,GAAMqE,EAASF,EAAG,GAAIG,EAAMH,EAAG,GACvD,OAAOtF,EAAO0F,SAASC,eAAe,kCAAmCH,EAAQC,GAAKG,MAAMC,IAGxF,IAAIC,EAAYD,EACZE,EAAM,EACVD,EAAUzC,KAAKY,EAAS+B,mBAAmBC,MAAK,SAAUtD,EAAKuD,GAAK,OAAOvD,EAAIxB,IAAIyB,aAAe4C,EAAO5C,aAAemD,EAAMG,KAAM,CAAM,IAC1IJ,EAAU1C,KAAK+C,MAAML,EAAWA,EAAUM,OAAO,EAAGL,IAEpD,IAAIZ,EAAW,IAAI,EAAAkB,mBAAmBlF,EAAK2E,EAAW5B,EAAMC,cAE5D,OADAD,EAAME,WAAWkC,IAAInF,EAAIyB,WAAYuC,GAC9BA,EAASE,KAAK,GAE7B,CACAkB,yBAAyBjD,EAAQC,GAE7B,OAAID,EAAEnC,IAAIyB,WAAaW,EAAEpC,IAAIyB,YAEjB,EAEHU,EAAEnC,IAAIyB,WAAaW,EAAEpC,IAAIyB,WAEvB,EAIAU,EAAEvC,MAAMiC,MAAMwD,UAAUjD,EAAExC,MAAMiC,MAE/C,CACAyD,qBAAqBtB,EAAeuB,GAKhC,IAAI7B,EAAMnE,KAAK0D,WAAWgB,IAAID,EAAShE,IAAIyB,YAC3C,GAAIiC,EAEA,OAAOA,EAAI8B,KAEnB,EA7FJ,aAEW,EAAAC,OAAS,aAmGpB,IAAIC,EAAM,EAMV,SAAgBtB,EAAepE,GAE3B,IAAImE,EAAKwB,KAAKC,MAAM5F,EAAI6F,OAAQxB,EAASF,EAAG,GAAInC,EAAOmC,EAAG,GAAIrC,EAAYqC,EAAG,GAC7E,MAAO,CAACtF,EAAOiH,IAAIF,MAAMvB,GAAS,IAAIxF,EAAOkH,SAAS/D,EAAMF,GAChE,CATA,0BAA+B9B,EAAUsE,GAErC,IAAIuB,EAAQF,KAAKK,UAAU,CAAChG,EAAIyB,WAAY6C,EAAItC,KAAMsC,EAAIxC,YAC1D,OAAOjD,EAAOiH,IAAIF,MAAM9C,EAAS2C,OAAS,yBAA2BI,EAAQ,IAAMH,IACvF,EACA,kB,6FC9GA,eACA,2BAYI3G,YAAYiB,EAAiB2E,EAA8BsB,GAEvD1G,KAAK2G,KAAOlG,EACZT,KAAK4G,WAAaxB,EAGlBpF,KAAK6G,SAAWH,EAEhB1G,KAAK8G,OAAS,CAAE,SAAW9G,KAAK4G,WAAW/E,OAAS,eACpD7B,KAAK+G,OAAS,GACd/G,KAAKgH,MAAQhH,KAAKiH,WACtB,CAEItC,YAEA,OAAO3E,KAAK8G,OAAOI,KAAK,KAC5B,CAIIjB,YAEA,OAAOjG,KAAK+G,MAChB,CAEAG,OAEI,OAAOlH,KAAKgH,KAChB,CACAC,YAEI,IAAIzD,EAAQxD,KACZ,GAA+B,IAA3BA,KAAK4G,WAAW/E,OAKpB,OAAO,IAAIsF,SAAQ,SAAUC,GAEzB,IAAIrF,EAAQ,EACRsF,EAAO,WAGP,GAAItF,GAASyB,EAAMoD,WAAW/E,OAE1BuF,EAAQ5D,OAFZ,CAWA,IAHA,IAAIvB,EAAMuB,EAAMoD,WAAW7E,GACvBtB,EAAMwB,EAAIxB,IACV6G,EAAS,CAACrF,EAAI5B,SACT0B,EAAQyB,EAAMoD,WAAW/E,SAE9BI,EAAMuB,EAAMoD,WAAW7E,IACftB,IAAIyB,aAAezB,EAAIyB,YAM3BoF,EAAO5E,KAAKT,EAAI5B,OAKxBmD,EAAM+D,yBAAyB9G,EAAK6G,GAAQpC,MAAK,SAAUsC,GAEvDhE,EAAMqD,SAASrF,KAAKgC,EAAMmD,MAC1BU,GACJ,G,CACJ,EACAA,GACJ,GACJ,CACAE,yBAAyB9G,EAAU6G,GAE/B,IAAI9D,EAAQxD,KAIZ,OAAOV,EAAO2E,UAAUwD,iBAAiBhH,GAAKyE,MAAK,SAAUf,GAEzDX,EAAMsD,OAAOpE,KAAK,GAAIjC,EAAIyB,YAC1B,IAAK,IAAIsD,EAAI,EAAGA,EAAI8B,EAAOzF,OAAQ2D,IACnC,CACI,IAAI/C,EAAO6E,EAAO9B,GAAGlD,MAAMG,KAC3Be,EAAMkE,eAAevD,EAAK1B,EAAM6E,EAAO9B,EAAI,IAC3ChC,EAAMmE,aAAaxD,EAAK1B,EAAM6E,EAAO9B,GAAI/E,GACzC+C,EAAMoE,gBAAgBzD,EAAK1B,EAAM6E,EAAO9B,EAAI,G,CAEpD,IAAG,SAAUqC,GAETrE,EAAMsD,OAAOpE,KAAK,GAAI,mBAAqBjC,EAAIyB,WAAa,QAAU4F,OAAOD,GAAM,GACvF,GACJ,CACAH,eAAevD,EAAU1B,EAAWsF,GAGhC,IADA,IAAIC,EAAOC,KAAKC,IAAI,EAAGzF,EAAO,EAAGsF,GAAYA,EAASvF,IAAIC,MAAQ,KACzDuF,EAAOvF,GAChB,CACI,IAAI0F,EAAOhE,EAAIiE,OAAOJ,GAAMG,KAC5BnI,KAAK8G,OAAOpE,KAAM,MAAQsF,EAAO,IAAOG,GAAQ,KAAOA,G,CAE/D,CACAR,aAAaxD,EAAU1B,EAAc4F,EAAqBvD,GAEtD,IAAIqD,EAAOhE,EAAIiE,OAAO3F,GAAM0F,KACxBG,EAAW,MAAQ7F,EAAO,GAAK,KAG/B8F,EAAMvI,KAAK8G,OAAOpE,KAAK4F,EAAWH,GAElCK,EAAY,IAAIlJ,EAAOmJ,MAAMF,EAAM,EAAGD,EAASzG,OAASwG,EAAM/F,MAAMC,UAAWgG,EAAM,EAAGD,EAASzG,OAASwG,EAAM7F,IAAID,WACpHmG,EAAa5D,EAAO6D,KAAK,CAAEC,SAAUd,OAAO,EAAIO,EAAM/F,MAAMG,QAChEzC,KAAK+G,OAAOrE,KAAK,IAAIpD,EAAOuJ,aAAaL,EAAWE,GACxD,CACAd,gBAAgBzD,EAAU1B,EAAW4E,GAEjC,IAAIyB,EAAKb,KAAKc,IAAI5E,EAAI6E,UAAWvG,EAAO,GACxC,KAAI4E,GAAQA,EAAK/E,MAAMG,KAAOqG,GAAM,GAApC,CAIA,OAASrG,EAAOqG,GAChB,CACI,IAAIX,EAAOhE,EAAIiE,OAAO3F,GAAM0F,KAC5BnI,KAAK8G,OAAOpE,KAAM,MAAQD,EAAO,IAAO0F,GAAQ,KAAOA,G,CAEvDd,GAEArH,KAAK8G,OAAOpE,KAAK,Q,CAEzB,E,UCvJJuG,EAAOC,QAAUC,QAAQ,S,GCCrBC,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBE,IAAjBD,EACH,OAAOA,EAAaL,QAGrB,IAAID,EAASG,EAAyBE,GAAY,CAGjDJ,QAAS,CAAC,GAOX,OAHAO,EAAoBH,GAAUL,EAAQA,EAAOC,QAASG,GAG/CJ,EAAOC,OACf,C,uGCpBA,eACA,SACA,SAkJA,SAASQ,IAERC,EAAuB,cACxB,CAEA,SAASC,IAERD,EAAuB,cACxB,CAGA,SAASA,EAAuBrJ,GAG/B,MAAMuJ,EAASvK,EAAOuE,OAAOiG,iBAC7B,GAAID,EACJ,CACC,MAAMpF,EAAWoF,EAAOpF,SAClBrE,EAAYyJ,EAAOzJ,UAEnB2J,EAAOtF,EAASuF,QAAQ5J,GAExB6J,EAAsB,gBAAZ3J,EAA4ByJ,EAAKL,cAAgBK,EAAKH,cAEtEC,EAAOK,MAAMC,IAEZA,EAAYC,QAAQhK,EAAW6J,EAAQ,G,CAG1C,CA3KA,oBAAyBI,GAGxBC,QAAQC,IAAI,oEAYZ,IAAIC,EAAYlL,EAAO0F,SAASyF,gBAAgB,wBAAyBf,GACrEgB,EAAYpL,EAAO0F,SAASyF,gBAAgB,wBAAyBb,GACzES,EAAQM,cAAcjI,KAAK8H,GAC3BH,EAAQM,cAAcjI,KAAKgI,GAO3B,MAAME,EAAmB,IAAIC,EAAQC,cAAa,GAClDxL,EAAOuE,OAAOkH,yBAAyB,8BAA+BH,GAEtE,MAAMI,EAAoB,IAAIH,EAAQC,cAAa,GACnDxL,EAAOuE,OAAOkH,yBAAyB,8BAA+BC,GAetE,IAAIC,EAAsB3L,EAAO0F,SAASkG,0BAA0B,qCAAqC,SAAUrB,GAElH,IAAIpJ,GAAM,IAAA0K,gBAAetB,EAAOpF,SAAShE,IAAKoJ,EAAOzJ,UAAUgL,QAC3DxG,GAAK,IAAAC,gBAAepE,GAAMqE,EAASF,EAAG,GAAIG,EAAMH,EAAG,GAIvD,OAFAtF,EAAO0F,SAASC,eAAe,oDAExB3F,EAAO0F,SAASC,eAAe,kCAAmCH,EAAQC,GAAKG,MAAMC,IAS3F,IAAI9D,EAqBP,SAAuBgK,GAEtB,IAAIhK,EAAwC,GAC5C,IAAK,IAAIU,EAAQ,EAAGA,EAAQsJ,EAAUxJ,OAAQE,IAC9C,CACC,MACMC,EAAoC,CACzCC,IAFWoJ,EAAUtJ,GAGrBK,SAAU,IAEXf,EAAYqB,KAAKV,E,CAElB,OAAOX,CACR,CAlCqBiK,CANFnG,IA0CnB,SAA4B9D,GAE3B,OAAO,IAAI8F,SAAQ,CAACC,EAASmE,KAE5B,IAAIC,EAAe,EACnB,IAAK,IAAIzJ,EAAQ,EAAGA,EAAQV,EAAYQ,OAAQE,IAChD,CACC,IAAIC,EAAYX,EAAYU,GACxBE,EAAMD,EAAUC,IAChBxB,EAAMwB,EAAIxB,IAEdnB,EAAO2E,UAAUwD,iBAAiBhH,GAAKyE,MAAMf,IAE5CnC,EAAUI,SAAW+B,EAAIiE,OAAOnG,EAAI5B,MAAMiC,MAAMG,MAAM0F,KACtD7I,EAAO0F,SAASC,eAAe,mCAAoCxE,EAAKwB,EAAI5B,MAAMiC,OAAO4C,MAAMuG,IAG9F,IAAIC,EAAgDD,EAEpD,IAAK,IAAIE,EAAI,EAAGA,EAAID,EAAkB7J,OAAQ8J,IAC9C,CACC,MAAMjK,EAAUgK,EAAkBC,GAC9B1J,EAAI5B,MAAMuL,QAAQlK,EAAQrB,SAEzBqB,EAAQmK,OAASvM,EAAOwM,sBAAsBC,MAEjD/J,EAAUhB,SAAU,EACVU,EAAQmK,OAASvM,EAAOwM,sBAAsBE,OAExDhK,EAAUhB,SAAU,G,CAIvBwK,IAEIA,GAAgBnK,EAAYQ,QAE/BuF,GAAWA,EAAQ,K,GAEnB,G,IAIN,EA9EG6E,CAAmB5K,GAAa6D,MAAK,KAEpC0F,EAAiBxH,eAAe/B,GAChC2J,EAAkB5H,eAAe/B,EAAY,GAC5C,GASJ,IAGAgJ,EAAQM,cAAcjI,KAAKuI,EAE5B,EA6GA,wBAA+B,C","sources":["webpack://groupreferences/./src/Tree.ts","webpack://groupreferences/./src/provider.ts","webpack://groupreferences/./src/referencesDocument.ts","webpack://groupreferences/external commonjs \"vscode\"","webpack://groupreferences/webpack/bootstrap","webpack://groupreferences/./src/extension.ts"],"sourcesContent":["import * as vscode from 'vscode';\r\n\r\nexport interface NodeInfo\r\n{\r\n    uri: vscode.Uri\r\n    name: string | vscode.TreeItemLabel,\r\n    isFile: boolean\r\n    line?: number\r\n    range?: vscode.Range\r\n}\r\n\r\nexport interface LocationSource\r\n{\r\n    loc: vscode.Location\r\n    lineText: string\r\n    isWrite?: boolean\r\n}\r\n\r\n// 树节点\r\nexport class NodeItem extends vscode.TreeItem\r\n{\r\n    info: NodeInfo\r\n\r\n    constructor(info: NodeInfo)\r\n    {\r\n        super(info.name, info.isFile ? vscode.TreeItemCollapsibleState.Expanded : vscode.TreeItemCollapsibleState.None)\r\n        this.info = info;\r\n\r\n        if (info.isFile == false)\r\n        {\r\n            const showDocOptions = {\r\n                preserveFocus: false,\r\n                preview: false,\r\n                // viewColumn: 1,\r\n\r\n                selection: info.range\r\n            };\r\n            this.command = {\r\n                command: \"vscode.open\", //命令id\r\n                title: \"标题\",\r\n                arguments: [info.uri, showDocOptions] //命令接收的参数\r\n            };\r\n        } else\r\n        {\r\n            this.iconPath = vscode.ThemeIcon.File;\r\n            this.description = info.uri.fsPath;\r\n            this.tooltip = info.uri.fsPath;\r\n        }\r\n    }\r\n}\r\n\r\n//树的内容组织管理\r\nexport class TreeProvider implements vscode.TreeDataProvider<NodeInfo>\r\n{\r\n\r\n\r\n    private refreshEvent: vscode.EventEmitter<NodeInfo | null | undefined> = new vscode.EventEmitter<NodeInfo | null | undefined>();\r\n\r\n    onDidChangeTreeData?: vscode.Event<void | NodeInfo | null | undefined> | undefined = this.refreshEvent.event;\r\n\r\n    public dataSources: LocationSource[] = []\r\n\r\n    private _isWriteTree: boolean = false;\r\n\r\n    constructor(isWrite: boolean)\r\n    {\r\n        this._isWriteTree = isWrite;\r\n    }\r\n\r\n    Refresh()\r\n    {\r\n        this.refreshEvent?.fire(null);\r\n    }\r\n\r\n    getTreeItem(element: NodeInfo): vscode.TreeItem | Thenable<vscode.TreeItem>\r\n    {\r\n        let item = new NodeItem(element);\r\n        return item;\r\n    }\r\n    getChildren(nodeInfo?: NodeInfo): vscode.ProviderResult<NodeInfo[]>\r\n    {\r\n\r\n        if (this.dataSources.length == 0)\r\n        {\r\n            return null;\r\n        }\r\n\r\n        if (nodeInfo)\r\n        {\r\n            if (nodeInfo.isFile == false)\r\n            {\r\n                return null\r\n            }\r\n            let children = [];\r\n            for (let index = 0; index < this.dataSources.length; index++)\r\n            {\r\n                let locSource = this.dataSources[index];\r\n                let loc = locSource.loc;\r\n                let uri = loc.uri;\r\n\r\n                if (this._isWriteTree)\r\n                {\r\n                    if (!locSource.isWrite)\r\n                    {\r\n                        continue;\r\n                    }\r\n                } else\r\n                {\r\n                    if (locSource.isWrite == true)\r\n                    {\r\n                        continue;\r\n                    }\r\n                }\r\n\r\n                if (uri.toString() != nodeInfo.uri.toString())\r\n                {\r\n                    continue;\r\n                }\r\n\r\n\r\n                let treeItemLabel: vscode.TreeItemLabel = {\r\n                    label: locSource.lineText,\r\n                    highlights: [[loc.range.start.character, loc.range.end.character]]\r\n                }\r\n\r\n                let info: NodeInfo = {\r\n                    uri: uri,\r\n                    name: treeItemLabel,\r\n                    isFile: false,\r\n                    line: loc.range.start.line,\r\n                    range: loc.range\r\n                }\r\n                children.push(info);\r\n            }\r\n\r\n            children.sort((a, b) =>\r\n            {\r\n                a.line = a.line ? a.line : 0;\r\n                b.line = b.line ? b.line : 0;\r\n                return a.line - b.line;\r\n            })\r\n            return children;\r\n        } else\r\n        {\r\n            let children = [];\r\n            var fileSet = new Set<string>();\r\n            for (let index = 0; index < this.dataSources.length; index++)\r\n            {\r\n                let locSource = this.dataSources[index];\r\n                let loc = locSource.loc;\r\n                let uri = loc.uri;\r\n\r\n                if (this._isWriteTree)\r\n                {\r\n                    if (!locSource.isWrite)\r\n                    {\r\n                        continue;\r\n                    }\r\n                } else\r\n                {\r\n                    if (locSource.isWrite == true)\r\n                    {\r\n                        continue;\r\n                    }\r\n                }\r\n\r\n                if (fileSet.has(uri.toString()))\r\n                {\r\n                    continue;\r\n                }\r\n                let info: NodeInfo = {\r\n                    uri: uri,\r\n                    name: this.getFileNameByPath(uri.path),\r\n                    isFile: true\r\n                }\r\n\r\n                fileSet.add(uri.toString());\r\n\r\n                children.push(info);\r\n            }\r\n            return children;\r\n        }\r\n    }\r\n\r\n    public SetDataSources(dataSources: LocationSource[])\r\n    {\r\n        this.dataSources = dataSources;\r\n        this.Refresh();\r\n    }\r\n\r\n\r\n    getFileNameByPath(path: string)\r\n    {\r\n        let index = path.lastIndexOf(\"\\\\\");\r\n        if (index == -1)\r\n        {\r\n            index = path.lastIndexOf(\"/\");\r\n        }\r\n        if (index != -1)\r\n        {\r\n            return path.substring(index + 1);\r\n        }\r\n        return path;\r\n    }\r\n\r\n}\r\n","\r\n// var vscode = require('vscode');\r\n// var referencesDocument_1 = require('./referencesDocument');\r\nimport * as vscode from 'vscode';\r\nimport { ReferencesDocument } from './referencesDocument';\r\n\r\nexport class Provider implements vscode.TextDocumentContentProvider, vscode.DocumentLinkProvider\r\n{\r\n    static scheme = 'references';\r\n\r\n    _onDidChange: vscode.EventEmitter<vscode.Uri>;\r\n    _documents: Map<string, ReferencesDocument>;\r\n    _editorDecoration: vscode.TextEditorDecorationType;\r\n    _subscriptions: vscode.Disposable;\r\n\r\n    constructor()\r\n    {\r\n        var _this = this;\r\n        this._onDidChange = new vscode.EventEmitter<vscode.Uri>();\r\n        this._documents = new Map<string, ReferencesDocument>();\r\n        this._editorDecoration = vscode.window.createTextEditorDecorationType({ textDecoration: 'underline' });\r\n        // Listen to the following events:\r\n        // * closeTextDocument - which means we must clear the corresponding model object - `ReferencesDocument`\r\n        this._subscriptions = vscode.workspace.onDidCloseTextDocument(function (doc) { return _this._documents.delete(doc.uri.toString()); });\r\n    }\r\n    dispose()\r\n    {\r\n        this._subscriptions.dispose();\r\n        this._documents.clear();\r\n        this._editorDecoration.dispose();\r\n        this._onDidChange.dispose();\r\n    }\r\n\r\n    /**\r\n         * Expose an event to signal changes of _virtual_ documents\r\n         * to the editor\r\n         */\r\n    get onDidChange()\r\n    {\r\n        return this._onDidChange.event;\r\n    }\r\n\r\n    /**\r\n     * Provider method that takes an uri of the `references`-scheme and\r\n     * resolves its content by (1) running the reference search command\r\n     * and (2) formatting the results\r\n     */\r\n    provideTextDocumentContent(uri: vscode.Uri)\r\n    {\r\n        var _this = this;\r\n        // already loaded?\r\n        var document = this._documents.get(uri.toString());\r\n        if (document)\r\n        {\r\n            return document.value;\r\n        }\r\n        // Decode target-uri and target-position from the provided uri and execute the\r\n        // `reference provider` command (http://code.visualstudio.com/docs/extensionAPI/vscode-api-commands).\r\n        // From the result create a references document which is in charge of loading,\r\n        // printing, and formatting references\r\n        var _a = decodeLocation(uri), target = _a[0], pos = _a[1];\r\n        return vscode.commands.executeCommand('vscode.executeReferenceProvider', target, pos).then((locationList) =>\r\n        {\r\n            // sort by locations and shuffle to begin from target resource\r\n            var locations = locationList as vscode.Location[]\r\n            var idx = 0;\r\n            locations.sort(Provider._compareLocations).find(function (loc, i) { return loc.uri.toString() === target.toString() && (idx = i) && true; });\r\n            locations.push.apply(locations, locations.splice(0, idx));\r\n            // create document and return its early state\r\n            var document = new ReferencesDocument(uri, locations, _this._onDidChange);\r\n            _this._documents.set(uri.toString(), document);\r\n            return document.value;\r\n        });\r\n    }\r\n    static _compareLocations(a: any, b: any)\r\n    {\r\n        if (a.uri.toString() < b.uri.toString())\r\n        {\r\n            return -1;\r\n        }\r\n        else if (a.uri.toString() > b.uri.toString())\r\n        {\r\n            return 1;\r\n        }\r\n        else\r\n        {\r\n            return a.range.start.compareTo(b.range.start);\r\n        }\r\n    }\r\n    provideDocumentLinks(document: any, token: any)\r\n    {\r\n        // While building the virtual document we have already created the links.\r\n        // Those are composed from the range inside the document and a target uri\r\n        // to which they point\r\n        var doc = this._documents.get(document.uri.toString());\r\n        if (doc)\r\n        {\r\n            return doc.links;\r\n        }\r\n    }\r\n}\r\n// var Provider = (function ()\r\n// {\r\n\r\n//     return Provider;\r\n// }());\r\n// exports.default = Provider;\r\nvar seq = 0;\r\nexport function encodeLocation(uri: any, pos: any)\r\n{\r\n    var query = JSON.stringify([uri.toString(), pos.line, pos.character]);\r\n    return vscode.Uri.parse(Provider.scheme + \":References.locations?\" + query + \"#\" + seq++);\r\n}\r\nexport function decodeLocation(uri: any)\r\n{\r\n    var _a = JSON.parse(uri.query), target = _a[0], line = _a[1], character = _a[2];\r\n    return [vscode.Uri.parse(target), new vscode.Position(line, character)];\r\n}","/*---------------------------------------------------------\r\n * Copyright (C) Microsoft Corporation. All rights reserved.\r\n *--------------------------------------------------------*/\r\nimport * as vscode from 'vscode';\r\nexport class ReferencesDocument\r\n{\r\n    private _uri: vscode.Uri\r\n    private _locations: vscode.Location[]\r\n    // The ReferencesDocument has access to the event emitter from\r\n    // the containg provider. This allows it to signal changes\r\n    private _emitter: vscode.EventEmitter<vscode.Uri>\r\n    // Start with printing a header and start resolving\r\n    private _lines\r\n    private _links: any[]\r\n    private _join\r\n\r\n    constructor(uri: vscode.Uri, locations: vscode.Location[], emitter: vscode.EventEmitter<vscode.Uri>)\r\n    {\r\n        this._uri = uri;\r\n        this._locations = locations;\r\n        // The ReferencesDocument has access to the event emitter from\r\n        // the containg provider. This allows it to signal changes\r\n        this._emitter = emitter;\r\n        // Start with printing a header and start resolving\r\n        this._lines = [(\"Found \" + this._locations.length + \" references\")];\r\n        this._links = [];\r\n        this._join = this._populate();\r\n    }\r\n\r\n    get value(): string\r\n    {\r\n        return this._lines.join('\\n');\r\n    }\r\n\r\n\r\n\r\n    get links()\r\n    {\r\n        return this._links;\r\n    }\r\n\r\n    join()\r\n    {\r\n        return this._join;\r\n    }\r\n    _populate()\r\n    {\r\n        var _this = this;\r\n        if (this._locations.length === 0)\r\n        {\r\n            return;\r\n        }\r\n        // fetch one by one, update doc asap\r\n        return new Promise(function (resolve)\r\n        {\r\n            var index = 0;\r\n            var next = function ()\r\n            {\r\n                // We have seen all groups\r\n                if (index >= _this._locations.length)\r\n                {\r\n                    resolve(_this);\r\n                    return;\r\n                }\r\n                // We know that this._locations is sorted by uri\r\n                // such that we can now iterate and collect ranges\r\n                // until the uri changes\r\n                var loc = _this._locations[index];\r\n                var uri = loc.uri;\r\n                var ranges = [loc.range];\r\n                while (++index < _this._locations.length)\r\n                {\r\n                    loc = _this._locations[index];\r\n                    if (loc.uri.toString() !== uri.toString())\r\n                    {\r\n                        break;\r\n                    }\r\n                    else\r\n                    {\r\n                        ranges.push(loc.range);\r\n                    }\r\n                }\r\n                // We have all ranges of a resource so that it be\r\n                // now loaded and formatted\r\n                _this._fetchAndFormatLocations(uri, ranges).then(function (lines)\r\n                {\r\n                    _this._emitter.fire(_this._uri);\r\n                    next();\r\n                });\r\n            };\r\n            next();\r\n        });\r\n    }\r\n    _fetchAndFormatLocations(uri: any, ranges: any)\r\n    {\r\n        var _this = this;\r\n        // Fetch the document denoted by the uri and format the matches\r\n        // with leading and trailing content form the document. Make sure\r\n        // to not duplicate lines\r\n        return vscode.workspace.openTextDocument(uri).then(function (doc)\r\n        {\r\n            _this._lines.push('', uri.toString());\r\n            for (var i = 0; i < ranges.length; i++)\r\n            {\r\n                var line = ranges[i].start.line;\r\n                _this._appendLeading(doc, line, ranges[i - 1]);\r\n                _this._appendMatch(doc, line, ranges[i], uri);\r\n                _this._appendTrailing(doc, line, ranges[i + 1]);\r\n            }\r\n        }, function (err)\r\n        {\r\n            _this._lines.push('', \"Failed to load '\" + uri.toString() + \"'\\n\\n\" + String(err), '');\r\n        });\r\n    }\r\n    _appendLeading(doc: any, line: any, previous: any)\r\n    {\r\n        var from = Math.max(0, line - 3, previous && previous.end.line || 0);\r\n        while (++from < line)\r\n        {\r\n            var text = doc.lineAt(from).text;\r\n            this._lines.push((\"  \" + (from + 1)) + (text && \"  \" + text));\r\n        }\r\n    }\r\n    _appendMatch(doc: any, line: number, match: vscode.Range, target: vscode.Uri)\r\n    {\r\n        var text = doc.lineAt(line).text;\r\n        var preamble = \"  \" + (line + 1) + \": \";\r\n        // Append line, use new length of lines-array as line number\r\n        // for a link that point to the reference\r\n        var len = this._lines.push(preamble + text);\r\n        // Create a document link that will reveal the reference\r\n        var linkRange = new vscode.Range(len - 1, preamble.length + match.start.character, len - 1, preamble.length + match.end.character);\r\n        var linkTarget = target.with({ fragment: String(1 + match.start.line) });\r\n        this._links.push(new vscode.DocumentLink(linkRange, linkTarget));\r\n    }\r\n    _appendTrailing(doc: any, line: any, next: any)\r\n    {\r\n        var to = Math.min(doc.lineCount, line + 3);\r\n        if (next && next.start.line - to <= 2)\r\n        {\r\n            return; // next is too close, _appendLeading does the work\r\n        }\r\n        while (++line < to)\r\n        {\r\n            var text = doc.lineAt(line).text;\r\n            this._lines.push((\"  \" + (line + 1)) + (text && \"  \" + text));\r\n        }\r\n        if (next)\r\n        {\r\n            this._lines.push(\"  ...\");\r\n        }\r\n    }\r\n}\r\n\r\n//# sourceMappingURL=referencesDocument.js.map","module.exports = require(\"vscode\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// The module 'vscode' contains the VS Code extensibility API\r\n// Import the module and reference it with the alias vscode in your code below\r\nimport * as vscode from 'vscode';\r\nimport * as sidebar from './Tree';\r\nimport { decodeLocation, encodeLocation } from './provider';\r\n\r\n// This method is called when your extension is activated\r\n// Your extension is activated the very first time the command is executed\r\nexport function activate(context: vscode.ExtensionContext)\r\n{\r\n\r\n\tconsole.log('Congratulations, your extension \"groupreferences\" is now active!');\r\n\r\n\t// let disposable = vscode.commands.registerCommand('groupreferences.helloWorld', () =>\r\n\t// {\r\n\t// \t// The code you place here will be executed every time your command is executed\r\n\t// \t// Display a message box to the user\r\n\t// \tvscode.window.showInformationMessage('Hello World from GroupReferences!I am a new extension of Yuk!');\r\n\t// });\r\n\r\n\t// context.subscriptions.push(disposable);\r\n\r\n\r\n\tlet lowerCase = vscode.commands.registerCommand('extension.toLowerCase', toLowerCase);\r\n\tlet upperCase = vscode.commands.registerCommand('extension.toUpperCase', toUpperCase);\r\n\tcontext.subscriptions.push(lowerCase);\r\n\tcontext.subscriptions.push(upperCase);\r\n\r\n\t// let referenceItemClkCmd = vscode.commands.registerCommand('groupreferences.referenceItemClk', OnReferenceItemClkCmd);\r\n\t// context.subscriptions.push(referenceItemClkCmd);\r\n\r\n\r\n\t//注册侧边栏面板的实现\r\n\tconst readDataProvider = new sidebar.TreeProvider(false);\r\n\tvscode.window.registerTreeDataProvider(\"sidebar_groupreferences_id1\", readDataProvider);\r\n\r\n\tconst writeDataProvider = new sidebar.TreeProvider(true);\r\n\tvscode.window.registerTreeDataProvider(\"sidebar_groupreferences_id2\", writeDataProvider);\r\n\r\n\r\n\t// //注册命令 \r\n\t// vscode.commands.registerCommand(\"sidebar_test_id1.openChild\", args =>\r\n\t// {\r\n\t// \tvscode.window.showInformationMessage(args);\r\n\t// });\r\n\r\n\t// var provider = new Provider()\r\n\r\n\t// var providerRegistrations = vscode.Disposable.from(\r\n\t// \tvscode.workspace.registerTextDocumentContentProvider(Provider.scheme, provider),\r\n\t// \tvscode.languages.registerDocumentLinkProvider({ scheme: Provider.scheme }, provider));\r\n\r\n\tvar commandRegistration = vscode.commands.registerTextEditorCommand('groupreferences.findAllReferences', function (editor: vscode.TextEditor)\r\n\t{\r\n\t\tvar uri = encodeLocation(editor.document.uri, editor.selection.active);\r\n\t\tvar _a = decodeLocation(uri), target = _a[0], pos = _a[1];\r\n\r\n\t\tvscode.commands.executeCommand('workbench.view.extension.sidebar_groupreferences');\r\n\r\n\t\treturn vscode.commands.executeCommand('vscode.executeReferenceProvider', target, pos).then((locationList) =>\r\n\t\t{\r\n\t\t\t// sort by locations and shuffle to begin from target resource\r\n\t\t\tvar locations = locationList as vscode.Location[];\r\n\t\t\t// var idx = 0;\r\n\t\t\t// locations.sort(Provider._compareLocations).find(function (loc, i) { return loc.uri.toString() === target.toString() && (idx = i) && true; });\r\n\t\t\t// locations.push.apply(locations, locations.splice(0, idx));\r\n\r\n\r\n\t\t\tlet dataSources = GenDataSource(locations);\r\n\t\t\tProcessDataSources(dataSources).then(() =>\r\n\t\t\t{\r\n\t\t\t\treadDataProvider.SetDataSources(dataSources);\r\n\t\t\t\twriteDataProvider.SetDataSources(dataSources);\r\n\t\t\t})\r\n\t\t});\r\n\r\n\r\n\t\t// var viewColumn = editor.viewColumn ? editor.viewColumn + 1 : undefined;\r\n\t\t// return vscode.workspace.openTextDocument(uri).then((doc: vscode.TextDocument) =>\r\n\t\t// {\r\n\t\t// \treturn vscode.window.showTextDocument(doc, viewColumn);\r\n\t\t// });\r\n\t});\r\n\t// context.subscriptions.push(provider, commandRegistration, providerRegistrations);\r\n\r\n\tcontext.subscriptions.push(commandRegistration);\r\n\r\n}\r\n\r\nfunction GenDataSource(Locations: vscode.Location[]): sidebar.LocationSource[]\r\n{\r\n\tlet dataSources: sidebar.LocationSource[] = [];\r\n\tfor (let index = 0; index < Locations.length; index++)\r\n\t{\r\n\t\tconst loc = Locations[index];\r\n\t\tconst locSource: sidebar.LocationSource = {\r\n\t\t\tloc: loc,\r\n\t\t\tlineText: \"\"\r\n\t\t};\r\n\t\tdataSources.push(locSource);\r\n\t}\r\n\treturn dataSources;\r\n}\r\n\r\nfunction ProcessDataSources(dataSources: sidebar.LocationSource[])\r\n{\r\n\treturn new Promise((resolve, reject) =>\r\n\t{\r\n\t\tlet processCount = 0;\r\n\t\tfor (let index = 0; index < dataSources.length; index++)\r\n\t\t{\r\n\t\t\tlet locSource = dataSources[index];\r\n\t\t\tlet loc = locSource.loc;\r\n\t\t\tlet uri = loc.uri;\r\n\r\n\t\t\tvscode.workspace.openTextDocument(uri).then((doc: vscode.TextDocument) =>\r\n\t\t\t{\r\n\t\t\t\tlocSource.lineText = doc.lineAt(loc.range.start.line).text;\r\n\t\t\t\tvscode.commands.executeCommand('vscode.executeDocumentHighlights', uri, loc.range.start).then((args: any) =>\r\n\t\t\t\t{\r\n\r\n\t\t\t\t\tlet documentHighlight: vscode.DocumentHighlight[] = args;\r\n\r\n\t\t\t\t\tfor (let I = 0; I < documentHighlight.length; I++)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tconst element = documentHighlight[I];\r\n\t\t\t\t\t\tif (loc.range.isEqual(element.range))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (element.kind === vscode.DocumentHighlightKind.Write)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tlocSource.isWrite = true;\r\n\t\t\t\t\t\t\t} else if (element.kind === vscode.DocumentHighlightKind.Read)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tlocSource.isWrite = false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tprocessCount++;\r\n\r\n\t\t\t\t\tif (processCount >= dataSources.length)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tresolve && resolve(null);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n}\r\n\r\n\r\nfunction toLowerCase()\r\n{\r\n\ttoLowerCaseOrUpperCase('toLowerCase');\r\n}\r\n\r\nfunction toUpperCase()\r\n{\r\n\ttoLowerCaseOrUpperCase('toUpperCase');\r\n}\r\n\r\n//转小写\r\nfunction toLowerCaseOrUpperCase(command: string)\r\n{\r\n\t//获取activeTextEditor\r\n\tconst editor = vscode.window.activeTextEditor;\r\n\tif (editor)\r\n\t{\r\n\t\tconst document = editor.document;\r\n\t\tconst selection = editor.selection;\r\n\t\t//获取选中单词文本\r\n\t\tconst word = document.getText(selection);\r\n\t\t//文本转大小写\r\n\t\tconst newWord = command === 'toLowerCase' ? word.toLowerCase() : word.toUpperCase();\r\n\t\t//替换原来文本\r\n\t\teditor.edit((editBuilder) =>\r\n\t\t{\r\n\t\t\teditBuilder.replace(selection, newWord);\r\n\t\t});\r\n\t}\r\n}\r\n\r\nfunction OnReferenceItemClkCmd(uri: vscode.Uri)\r\n{\r\n\t// const showDocOptions = {\r\n\t// \tpreserveFocus: false,\r\n\t// \tpreview: false,\r\n\t// \tviewColumn: 1,\r\n\r\n\t// \t// replace with your line_number's\r\n\t// \tselection: new vscode.Range(314, 0, 314, 0)\r\n\t// };\r\n\r\n\t// let doc = await vscode.window.showTextDocument(setting, showDocOptions);\r\n}\r\n\r\n// This method is called when your extension is deactivated\r\nexport function deactivate() { }\r\n"],"names":["NodeItem","vscode","TreeItem","constructor","info","super","name","isFile","TreeItemCollapsibleState","Expanded","None","this","showDocOptions","preserveFocus","preview","selection","range","command","title","arguments","uri","iconPath","ThemeIcon","File","description","fsPath","tooltip","isWrite","refreshEvent","EventEmitter","onDidChangeTreeData","event","dataSources","_isWriteTree","Refresh","fire","getTreeItem","element","getChildren","nodeInfo","length","children","index","locSource","loc","toString","label","lineText","highlights","start","character","end","line","push","sort","a","b","fileSet","Set","has","getFileNameByPath","path","add","SetDataSources","lastIndexOf","substring","Provider","_this","_onDidChange","_documents","Map","_editorDecoration","window","createTextEditorDecorationType","textDecoration","_subscriptions","workspace","onDidCloseTextDocument","doc","delete","dispose","clear","onDidChange","provideTextDocumentContent","document","get","value","_a","decodeLocation","target","pos","commands","executeCommand","then","locationList","locations","idx","_compareLocations","find","i","apply","splice","ReferencesDocument","set","static","compareTo","provideDocumentLinks","token","links","scheme","seq","JSON","parse","query","Uri","Position","stringify","emitter","_uri","_locations","_emitter","_lines","_links","_join","_populate","join","Promise","resolve","next","ranges","_fetchAndFormatLocations","lines","openTextDocument","_appendLeading","_appendMatch","_appendTrailing","err","String","previous","from","Math","max","text","lineAt","match","preamble","len","linkRange","Range","linkTarget","with","fragment","DocumentLink","to","min","lineCount","module","exports","require","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","toLowerCase","toLowerCaseOrUpperCase","toUpperCase","editor","activeTextEditor","word","getText","newWord","edit","editBuilder","replace","context","console","log","lowerCase","registerCommand","upperCase","subscriptions","readDataProvider","sidebar","TreeProvider","registerTreeDataProvider","writeDataProvider","commandRegistration","registerTextEditorCommand","encodeLocation","active","Locations","GenDataSource","reject","processCount","args","documentHighlight","I","isEqual","kind","DocumentHighlightKind","Write","Read","ProcessDataSources"],"sourceRoot":""}